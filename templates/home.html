<!DOCTYPE html>
<html>
<head>
  <meta charset='UTF-8'>
  <link rel="stylesheet" href="/static/home.css">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <title>Home</title>
</head>

<body>
  <header>
    <!-- Top menu -->
    <div class="w3-top">
      <div class="w3-white w3-xlarge" style="max-width:1200px;margin:auto">
        <div class="w3-button w3-right w3-padding-16">
          <form action='/logout'>
            <input type='submit' name='logout' value='Logout'/>
          </form>
        </div>
      </div>
    </div>
  </header>

  <!-- !PAGE CONTENT! -->
  <div class="w3-main w3-content w3-padding" style="max-width:1200px;margin-top:100px">
    <!-- About Section -->
    <div class="w3-container w3-padding-32 w3-center">  
      <h3><b>Welcome to pyBase, {{username}}!</b></h3>
    </div>
    <div class="w3-container w3-padding-32 w3-center">
      <h4>Students</h4>
      <form action='/insert-student'>
        <input type='submit' name='insert-student' value='Create Student'>
      </form>
      <br>
      {% if students != None %}
      <table align='center' class="tablesorter">
        <thead>
          <tr>
            <th onclick='sortTable(0)'>Student ID</th>
            <th onclick='sortTable(1)'>Name</th>
          </tr>
        </thead>
        <tbody>
          {% for student in students %}
          <tr>
            <td><a href="{{url_for('student', student_id=student.student_id)}}">{{student.student_id}}</a></td>
            <td>{{student.name}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <script>
      function sortTable(n) {
        var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
        table = document.getElementById("myTable");
        switching = true;
            //Set the sorting direction to ascending:
            dir = "asc"; 
              /*Make a loop that will continue until
              no switching has been done:*/
              while (switching) {
                      //start by saying: no switching is done:
                      switching = false;
                      rows = table.getElementsByTagName("TR");
                              /*Loop through all table rows (except the
                                first, which contains table headers):*/
for (i = 1; i < (rows.length - 1); i++) {
                                         //start by saying there should be no switching:
                                         shouldSwitch = false;
                                         /*Get the two elements you want to compare,
                                         one from current row and one from the next:*/
                                         x = rows[i].getElementsByTagName("TD")[n];
                                         y = rows[i + 1].getElementsByTagName("TD")[n];
                                         /*check if the two rows should switch place,
                                         based on the direction, asc or desc:*/
                                         if (dir == "asc") {
                                           if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                                                         //if so, mark as a switch and break the loop:
                                                         shouldSwitch= true;
                                                         break;
                                                       }
                                                     } else if (dir == "desc") {
                                                       if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                                                                           //if so, mark as a switch and break the loop:
                                                                           shouldSwitch= true;
                                                                           break;
                                                                         }
                                                                       }
                                                                     }
                                                                     if (shouldSwitch) {
                                            /*If a switch has been marked, make the switch
                                            and mark that a switch has been done:*/
                                            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                                            switching = true;
                                                        //Each time a switch is done, increase this count by 1:
                                                        switchcount ++;      
                                                      } else {
                                                                      /*If no switching has been done AND the direction is "asc",
                                                                      set the direction to "desc" and run the while loop again.*/
                                                                      if (switchcount == 0 && dir == "asc") {
                                                                        dir = "desc";
                                                                        switching = true;
                                                                      }
                                                                    }
                                                                  }
                                                                }
                                                                </script>
                                                                {% else %}
                                                                <h3>Currenly no students in the database.</h3>
                                                                {% endif %}
                                                              </div>
                                                              <hr>

                                                              <footer>

                                                              </footer>
                                                            </div>
                                                          </body>
                                                          </html>
